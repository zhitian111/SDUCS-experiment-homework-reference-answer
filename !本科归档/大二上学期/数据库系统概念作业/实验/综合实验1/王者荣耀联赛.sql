USE FOR_HOME_WORK;
GO

CREATE SCHEMA [KINGSHONER] AUTHORIZATION DBO;
GO

CREATE TABLE KINGSHONER.[TEAM](
    TID INT PRIMARY KEY,
    NAME VARCHAR(20),
    FOUNDING_DATE DATE
);
GO

CREATE TABLE KINGSHONER.[PLAYER](
    PID INT PRIMARY KEY,
    NAME VARCHAR(20),
    DATEOFBIRTH DATE,
    GENDER VARCHAR(10),
    POSITION VARCHAR(20),
    TID INT,
    FOREIGN KEY (TID) REFERENCES KINGSHONER.[TEAM](TID)
);
GO

CREATE TABLE KINGSHONER.[MATCH](
    HOST_TID INT,
    GUEST_TID INT,
    TIME DATE,
    LOCATION VARCHAR(50),
    DURATION DATE,
    HOST_WIN INT,
    MID INT PRIMARY KEY,
    FOREIGN KEY (HOST_TID) REFERENCES KINGSHONER.[TEAM](TID),
    FOREIGN KEY (GUEST_TID) REFERENCES KINGSHONER.[TEAM](TID)
);
GO

CREATE TABLE KINGSHONER.[CHAMPION](
    CID INT PRIMARY KEY,
    NAME VARCHAR(20),
    DESCRIPTION VARCHAR(100),
    DMG_SCORE INT,
    LIFE_SCORE INT,
    DFD_SCORE INT
);
GO

CREATE TABLE KINGSHONER.[CHOOSE](
    PID INT,
    CID INT,
    MID INT,
    RANK INT,
    PRIMARY KEY (PID, MID),
    FOREIGN KEY (PID) REFERENCES KINGSHONER.[PLAYER](PID),
    FOREIGN KEY (CID) REFERENCES KINGSHONER.[CHAMPION](CID),
    FOREIGN KEY (MID) REFERENCES KINGSHONER.[MATCH](MID)
);
GO

CREATE TABLE KINGSHONER.[BAN](
    PID INT,
    MID INT,
    CID INT,
    RANK INT,
    FOREIGN KEY (PID) REFERENCES KINGSHONER.[PLAYER](PID),
    FOREIGN KEY (MID) REFERENCES KINGSHONER.[MATCH](MID),
    FOREIGN KEY (CID) REFERENCES KINGSHONER.[CHAMPION](CID),
    PRIMARY KEY (PID, MID)
);
GO

CREATE TABLE KINGSHONER.[DAMAGE](
    MID INT,
    A_PID INT,
    B_PID INT,
    AMOUNT INT,
    TIME DATE FOREIGN KEY (MID) REFERENCES KINGSHONER.[MATCH](MID),
    FOREIGN KEY (A_PID) REFERENCES KINGSHONER.[PLAYER](PID),
    FOREIGN KEY (B_PID) REFERENCES KINGSHONER.[PLAYER](PID),
    PRIMARY KEY (MID, A_PID, B_PID)
);
GO

CREATE TABLE KINGSHONER.[KILL](
    MID INT,
    A_PID INT,
    B_PID INT,
    TIME DATE,
    FOREIGN KEY (MID) REFERENCES KINGSHONER.[MATCH](MID),
    FOREIGN KEY (A_PID) REFERENCES KINGSHONER.[PLAYER](PID),
    FOREIGN KEY (B_PID) REFERENCES KINGSHONER.[PLAYER](PID),
    PRIMARY KEY (MID, A_PID, B_PID)
);
GO

CREATE TABLE KINGSHONER.[GRAND](
    MID INT,
    PID INT,
    TIME DATE,
    FOREIGN KEY (MID) REFERENCES KINGSHONER.[MATCH](MID),
    FOREIGN KEY (PID) REFERENCES KINGSHONER.[PLAYER](PID),
    PRIMARY KEY (MID, PID)
);
GO