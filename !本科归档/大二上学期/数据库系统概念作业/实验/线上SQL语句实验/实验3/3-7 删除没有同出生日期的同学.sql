CREATE TABLE TEST3_07 AS
    SELECT
        *
    FROM
        PUB.STUDENT_31
    WHERE
        SEX IN ('男', '女');

DROP TABLE TEST3_07;


DELETE FROM TEST3_07
WHERE
    CONCAT(CONCAT(EXTRACT(MONTH FROM BIRTHDAY), '-'), EXTRACT(DAY FROM BIRTHDAY)) NOT IN (
        SELECT
            CONCAT(CONCAT(EXTRACT(MONTH FROM BIRTHDAY), '-'), EXTRACT(DAY FROM BIRTHDAY)) AS MD
        FROM
            TEST3_07
        GROUP BY
            CONCAT(CONCAT(EXTRACT(MONTH FROM BIRTHDAY), '-'), EXTRACT(DAY FROM BIRTHDAY))
        HAVING
            COUNT(DISTINCT SEX) = 2
    );

DELETE FROM TEST3_07
WHERE
    BIRTHDAY NOT IN (
        SELECT
            BIRTHDAY,
            COUNT(DISTINCT SEX) AS COUNT
        FROM
            TEST3_07
        GROUP BY
            BIRTHDAY
        HAVING
            COUNT(DISTINCT SEX) = 2
    );